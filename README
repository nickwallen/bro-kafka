======================
Bro Logging with Kafka
======================

A Bro Log filter that sends log data to Kafka (http://kafka.apache.org/).  This
provides a convenient means for tools in the Hadoop ecosystem, such as Storm,
Spark, and others, to process the log data generated by Bro.

Installation
------------

Download and compile Bro from source code.  Replace version 2.4.1 with the
most recent stable release.  See the INSTALL documentation within the Bro release
for more details on prerequisites and compilation.

```
curl https://www.bro.org/downloads/release/bro-2.4.1.tar.gz | tar -xvz
cd bro-2.4.1
./configure
make
sudo make install
export BRO_HOME=`pwd`
```

Download and compile this Kafka plugin for Bro.

```
./configure --bro-dist=$BRO_HOME
make
sudo make install
```

Optional: Instead of running `make install` as above, after the plugin has been
compiled, the `build` directory can be added to the `BRO_PLUGIN_PATH`.  Bro will
automatically load any plugins that it finds at this location.

```
export BRO_PLUGIN_PATH="/home/the-dude/bro-plugin-kafka/build/"
```

Run the following command to ensure that the plugin was installed successfully.
The 'bro' executable must be in your PATH.

```
bro -N Metron::Kafka
```

Getting Started
---------------

Create a bro script to active the plugin.  Alternatively, this can be placed in
the site local file such as `/usr/local/bro/share/bro/site/local.bro`.  This will
direct all HTTP, DNS, and Conn logs to the Kafka topic called 'bro'.

```
@load Metron/Kafka/logs-to-kafka.bro
redef Kafka::logs_to_send = set(Conn::LOG, HTTP::LOG, DNS::LOG);
redef Kafka::kafka_broker_list = "localhost:9092";
redef Kafka::topic_name = "bro";
```
